<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Mod Farma Checklist</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        
        /* Základní styl inspirovaný Create modem (tmavý, industriální) */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #3f3f46; /* Šedý odstín (slate-700) - jako kov/blackstone */
        }
        #app {
            background-color: #27272a; /* Tmavší pozadí (zinc-800) */
            border: 4px solid #52525b; /* Silný rámeček (zinc-600) */
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5);
        }
        h1, h2 {
            color: #f5f5f5; /* Světlá barva textu */
            text-shadow: 1px 1px 0 #18181b;
        }
        /* Industriální linka a akcent */
        .border-create-accent {
            border-color: #FFA500; /* Žlutá/Oranžová Create akcent */
        }
        
        /* Položky checklistu */
        .checklist-item {
            background-color: #333333; /* Tmavý podklad pro položku */
            border: 2px solid #52525b;
        }
        .checklist-item:hover {
            background-color: #444444;
        }
        
        /* Zaškrtnuté položky */
        .checked-item {
            text-decoration: line-through;
            color: #a1a1aa; /* Světlejší šedá */
        }
        .note {
            font-size: 0.8em;
            color: #facc15; /* Žlutý akcent pro poznámky */
            margin-left: 0.5rem;
            font-weight: 700;
        }
        .qty {
            color: #7dd3fc; /* Modrý akcent pro množství (sky-300) */
        }

        /* Checkbox styl (pro lepší viditelnost na tmavém) */
        input[type="checkbox"] {
            border-color: #52525b;
            background-color: #18181b;
            color: #facc15; /* Žlutý akcent při zaškrtnutí */
            transition: all 0.1s;
        }
        input[type="checkbox"]:checked {
            background-color: #facc15;
            border-color: #facc15;
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div id="app" class="max-w-4xl mx-auto shadow-xl p-6 sm:p-10">
        <h1 class="text-3xl sm:text-4xl font-extrabold mb-2 border-b-4 border-create-accent pb-2">
            ⚙️ Cobblestone farma checklist
        </h1>
        <p class="text-gray-300 mb-6">
            Lokální uložení: Váš postup je uložen přímo ve vašem prohlížeči a bude k dispozici i po stažení souboru.
        </p>

        <!-- Sekce I: Hotové Položky -->
        <h2 class="text-2xl font-bold mt-6 mb-3 border-b border-gray-500 pb-1">I. Hotové Položky (Pro instalaci)</h2>
        <div id="checklistContainerFinished" class="space-y-3">
            <!-- Hotové položky budou vloženy sem -->
        </div>

        <!-- Sekce II: Suroviny pro Crafting -->
        <h2 class="text-2xl font-bold mt-8 mb-3 border-b border-gray-500 pb-1">II. Suroviny pro Crafting (Základní materiály)</h2>
        <div id="checklistContainerRaw" class="space-y-3">
            <!-- Suroviny pro crafting budou vloženy sem -->
        </div>
        
    </div>

    <script>
        // --- DATA A LOKÁLNÍ ÚLOŽIŠTĚ ---
        const STORAGE_KEY_FINISHED = 'createFarmFinished';
        const STORAGE_KEY_RAW = 'createFarmRaw';

        let finishedItemsData = []; 
        let rawMaterialsData = [];  

        // I. Výchozí data pro Hotové Položky
        const defaultFinishedItems = [
            { id: 1, qty: 1, item: "Soul Soil", checked: false, type: "finished" },
            { id: 2, qty: 3, item: "Framed Glass", checked: false, type: "finished" },
            { id: 3, qty: 1, item: "Soul Fire", checked: false, type: "finished" },
            { id: 4, qty: 19, item: "Framed Glass Trapdoor", checked: false, type: "finished" },
            { id: 5, qty: 9, item: "Encased Chain Drive", checked: false, type: "finished" },
            { id: 6, qty: 5, item: "Shaft", checked: false, type: "finished" },
            { id: 7, qty: 7, item: "Item Vault", checked: false, type: "finished" },
            { id: 8, qty: 6, item: "Belt", checked: false, type: "finished" },
            { id: 9, qty: 2, item: "Stockpile Switch", checked: false, type: "finished" },
            { id: 10, qty: 2, item: "Redstone Link", checked: false, type: "finished" },
            { id: 11, qty: 1, item: "Depot", checked: false, type: "finished" },
            { id: 12, qty: 1, item: "Oak Wall Sign", checked: false, type: "finished" },
            { id: 13, qty: 2, item: "Gearbox", checked: false, type: "finished" },
            { id: 14, qty: 2, item: "Brass Belt Funnel", checked: false, type: "finished" },
            { id: 15, qty: 1, item: "Andesite Belt Funnel", checked: false, type: "finished" },
            { id: 16, qty: 1, item: "Encased Fan", checked: false, type: "finished" },
            { id: 17, qty: 1, item: "Clutch", checked: false, type: "finished" },
            { id: 18, qty: 3, item: "Chute", checked: false, type: "finished" },
            { id: 19, qty: 3, item: "Mechanical Drill", checked: false, type: "finished" },
            { id: 20, qty: 1, item: "Cobblestone", checked: false, type: "finished" },
        ];

        // II. Výchozí data pro Suroviny pro Crafting
        const defaultRawMaterials = [
            { id: 21, qty: 31, item: "Andesite Alloy", checked: false, type: "raw", note: "Základní Create materiál" },
            { id: 22, qty: 63, item: "Železný Ingot", checked: false, type: "raw" },
            { id: 23, qty: 14, item: "Železný Nugget", checked: false, type: "raw" },
            { id: 24, qty: 9, item: "Kůže", checked: false, type: "raw", note: "Na výrobu pásů (Belt)" },
            { id: 25, qty: 7, item: "Chest", checked: false, type: "raw", note: "Na Item Vault" },
            { id: 26, qty: 2, item: "Brass Ingot", checked: false, type: "raw" },
            { id: 27, qty: 4, item: "Polished Diorite", checked: false, type: "raw" },
            { id: 28, qty: 3, item: "Redstone Dust", checked: false, type: "raw" },
            { id: 29, qty: 3, item: "Wool", checked: false, type: "raw", note: "Na Funnel" },
            { id: 30, qty: 8, item: "Glass Block", checked: false, type: "raw", note: "Na Framed Glass" },
            { id: 31, qty: 11, item: "Wood Planks", checked: false, type: "raw", note: "Různé použití" },
            { id: 32, qty: 1, item: "Stick", checked: false, type: "raw", note: "Na ceduli (Sign)" },
            { id: 33, qty: 1, item: "Flint and Steel", checked: false, type: "raw", note: "Na Soul Fire" },
        ];
        
        /**
         * Ukládá aktuální stav obou checklistů do localStorage.
         */
        function saveChecklistToLocalStorage() {
            try {
                localStorage.setItem(STORAGE_KEY_FINISHED, JSON.stringify(finishedItemsData));
                localStorage.setItem(STORAGE_KEY_RAW, JSON.stringify(rawMaterialsData));
            } catch (e) {
                console.error("Chyba při ukládání do LocalStorage:", e);
            }
        }
        
        /**
         * Načítá stav z localStorage, nebo používá defaultní data.
         */
        function loadChecklistFromLocalStorage() {
            try {
                const savedFinished = localStorage.getItem(STORAGE_KEY_FINISHED);
                const savedRaw = localStorage.getItem(STORAGE_KEY_RAW);

                if (savedFinished) {
                    const loadedData = JSON.parse(savedFinished);
                    // Aby se zachovala původní struktura, zkopírujeme defaultní a aplikujeme zaškrtnutí
                    finishedItemsData = JSON.parse(JSON.stringify(defaultFinishedItems));
                    loadedData.forEach(savedItem => {
                        const defaultItem = finishedItemsData.find(d => d.id === savedItem.id);
                        if (defaultItem) {
                            defaultItem.checked = savedItem.checked;
                        }
                    });
                } else {
                    finishedItemsData = defaultFinishedItems;
                }

                if (savedRaw) {
                    const loadedData = JSON.parse(savedRaw);
                    rawMaterialsData = JSON.parse(JSON.stringify(defaultRawMaterials));
                    loadedData.forEach(savedItem => {
                        const defaultItem = rawMaterialsData.find(d => d.id === savedItem.id);
                        if (defaultItem) {
                            defaultItem.checked = savedItem.checked;
                        }
                    });
                } else {
                    rawMaterialsData = defaultRawMaterials;
                }
                
            } catch (e) {
                console.error("Chyba při načítání z LocalStorage:", e);
                // V případě chyby se použijí defaultní data
                finishedItemsData = defaultFinishedItems;
                rawMaterialsData = defaultRawMaterials;
            }
            
            // Po načtení/nastavení dat se hned renderuje
            renderChecklist(finishedItemsData, 'checklistContainerFinished');
            renderChecklist(rawMaterialsData, 'checklistContainerRaw');
        }


        /**
         * Renderuje checklist do DOMu.
         */
        function renderChecklist(data, containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;

            container.innerHTML = ''; // Vyčistíme kontejner

            data.forEach(item => {
                const isChecked = item.checked;
                const listItem = document.createElement('div');
                listItem.className = `flex items-center p-3 checklist-item transition-all ${isChecked ? 'opacity-70' : ''}`;
                listItem.innerHTML = `
                    <input type="checkbox" id="item-${item.id}" data-id="${item.id}" data-type="${item.type}" ${isChecked ? 'checked' : ''}
                           class="h-5 w-5 border-create-accent rounded-sm focus:ring-create-accent cursor-pointer">
                    <label for="item-${item.id}" class="ml-4 flex-1 text-lg font-medium cursor-pointer flex justify-between items-center ${isChecked ? 'checked-item' : 'text-gray-100'}">
                        <span>
                            <span class="font-extrabold qty mr-2">${item.qty} X</span> ${item.item}
                            ${item.note ? `<span class="note">${item.note}</span>` : ''}
                        </span>
                    </label>
                `;

                // Přidání posluchače událostí na checkbox
                const checkbox = listItem.querySelector('input[type="checkbox"]');
                if (checkbox) {
                    checkbox.addEventListener('change', (e) => toggleItem(e.target.dataset.id, e.target.dataset.type, e.target.checked));
                }

                container.appendChild(listItem);
            });
        }

        /**
         * Přepíná stav zaškrtnutí položky a spouští uložení.
         */
        function toggleItem(itemId, itemType, newCheckedState) {
            const id = parseInt(itemId);
            let targetArray = itemType === 'finished' ? finishedItemsData : rawMaterialsData;
            let containerId = itemType === 'finished' ? 'checklistContainerFinished' : 'checklistContainerRaw';
            
            const itemIndex = targetArray.findIndex(item => item.id === id);

            if (itemIndex > -1) {
                targetArray[itemIndex].checked = newCheckedState;
                // Překreslení pro okamžitou vizuální zpětnou vazbu
                renderChecklist(targetArray, containerId); 
                // Uložit do LocalStorage po změně stavu
                saveChecklistToLocalStorage();
            }
        }

        // Spuštění načítání dat po načtení okna
        window.onload = function() {
            // Odebrání loading indikátoru, který už není potřeba
            const loadingIndicator = document.getElementById('loadingIndicator');
            if (loadingIndicator) {
                 loadingIndicator.remove();
            }
            loadChecklistFromLocalStorage();
        };

    </script>
</body>
</html>
